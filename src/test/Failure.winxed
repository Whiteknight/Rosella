namespace Rosella { namespace Test
{
    /* A test failure. Set up and throw an exception with this object as a
       payload to signal an assertion failure (as opposed to other kind of
       runtime error).
    */
    class Failure
    {
        var exception;
        var is_internal;

        // Build the exception object. If the exception is_internal, we won't
        // show a backtrace.
        function BUILD(string msg, int is_internal)
        {
            self.is_internal = is_internal;
            self.exception = new 'Exception';
            self.exception.message = msg;
            self.exception.payload = self;
        }

        function throw()
        {
            throw self.exception;
        }
    }
}}
